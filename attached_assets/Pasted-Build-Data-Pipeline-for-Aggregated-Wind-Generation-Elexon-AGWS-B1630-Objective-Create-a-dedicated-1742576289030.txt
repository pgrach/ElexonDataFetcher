Build Data Pipeline for Aggregated Wind Generation (Elexon AGWS/B1630)
Objective:
Create a dedicated data pipeline to retrieve historic actual or estimated wind generation data from Elexon's API endpoint (/generation/actual/per-type/wind-and-solar).
The pipeline must specifically aggregate wind generation (combining "Wind Onshore" and "Wind Offshore") per settlement date and period, and ingest this aggregated data into our database.

API Details:
Endpoint:
bash
Copy
Edit
GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/wind-and-solar
Required parameters:
from: Start date (YYYY-MM-DD)
to: End date (YYYY-MM-DD) (maximum 7 days per request)
Optional filters:
settlementPeriodFrom (integer, 1–48)
settlementPeriodTo (integer, 1–48)
Data format: JSON (format=json), returned data includes metadata.
Pipeline Steps:
Extract Data:

Call the API daily for the full range of settlement periods (1–48).
Limit each API request to a maximum of 7-day intervals, as per API restrictions.
Filter and Aggregate:

Extract entries where:
json
Copy
Edit
"businessType": "Wind generation",
"psrType": "Wind Onshore" or "Wind Offshore"
Aggregate the quantity values for each unique:
settlementDate
settlementPeriod
Example aggregation logic:
ini
Copy
Edit
aggregated_quantity = sum(Wind Onshore quantity + Wind Offshore quantity)
Ingest Aggregated Data into Database:

Save aggregated data in the following format:
settlement_date	settlement_period	aggregated_quantity
2025-01-01	21	19196.553
(This table represents the combined wind onshore/offshore generation quantity.)

Real-Time Updates & Reconciliation:

Ensure the pipeline continuously updates throughout 2025.
Include automated real-time ingestion or frequent periodic polling (e.g., hourly updates) to capture changes in published data.
Implement reconciliation logic:
Check existing entries for updates/corrections based on the publishTime.
If newer data is available, overwrite or update existing records.
Example API Request:
bash
Copy
Edit
curl -X GET \
'https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/wind-and-solar?from=2025-01-01&to=2025-01-07&settlementPeriodFrom=1&settlementPeriodTo=48&format=json' \
-H 'accept: application/json'
Example API Response Snippet:
json
Copy
Edit
{
  "metadata": {
    "datasets": ["AGWS"]
  },
  "data": [
    {
      "publishTime": "2025-01-01T11:28:21Z",
      "businessType": "Wind generation",
      "psrType": "Wind Onshore",
      "quantity": 7484.653,
      "settlementDate": "2025-01-01",
      "settlementPeriod": 21
    },
    {
      "publishTime": "2025-01-01T11:28:21Z",
      "businessType": "Wind generation",
      "psrType": "Wind Offshore",
      "quantity": 11711.9,
      "settlementDate": "2025-01-01",
      "settlementPeriod": 21
    },
    {
      "publishTime": "2025-01-01T11:28:21Z",
      "businessType": "Solar generation",
      "psrType": "Solar",
      "quantity": 241,
      "settlementDate": "2025-01-01",
      "settlementPeriod": 21
    }
  ]
}
Important Notes:
Ignore solar generation data (psrType: "Solar").
Ensure robust error handling (HTTP 400, 429, 500).
Structure code clearly for easy debugging and future enhancements.
